#include "aes.h"
#include <stdint.h>
#include <stdio.h>

void aes_cypher_128_test()
{
	uint8_t buf[] = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
					 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff,
					 0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
					 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff};
	uint8_t key[] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
					 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f};
	printf("\nAES_CIPHER_128 encrypt test case:\n");
	printf("Input:\n");
	aes_dump("data", buf, sizeof(buf));
	aes_dump("key ", key, sizeof(key));

	aes_encrypt(AES_CYPHER_128, buf, sizeof(buf), key);
	aes_dump("cipher", buf, sizeof(buf));

	printf("\nAES_CIPHER_128 decrypt test case:\n");
	printf("Input:\n");
	aes_dump("data", buf, sizeof(buf));
	aes_dump("key ", key, sizeof(key));

	aes_decrypt(AES_CYPHER_128, buf, sizeof(buf), key);
	aes_dump("plain", buf, sizeof(buf));
}

void aes_cypher_ecb_128_test()
{

	uint8_t buf[] = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
					 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff,
					 0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
					 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff};
	uint8_t key[] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
					 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f};

	printf("\nAES_CIPHER_128 ECB encrypt test case:\n");
	printf("Input:\n");
	aes_dump("data", buf, sizeof(buf));
	aes_dump("key ", key, sizeof(key));

	aes_encrypt_ecb(AES_CYPHER_128, buf, sizeof(buf), key);
	aes_dump("cipher", buf, sizeof(buf));

	printf("\nAES_CIPHER_128 ECB decrypt test case:\n");
	printf("Input:\n");
	aes_dump("data", buf, sizeof(buf));
	aes_dump("key ", key, sizeof(key));

	aes_decrypt_ecb(AES_CYPHER_128, buf, sizeof(buf), key);
	aes_dump("plain", buf, sizeof(buf));
}

void aes_cypher_cbc_128_test()
{

	uint8_t buf[] = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
					 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff,
					 0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
					 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff};
	uint8_t key[] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
					 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f};
	uint8_t iv[] = {0x60, 0xef, 0x17, 0x10, 0xd7, 0xcc, 0x28, 0xf8,
					0x56, 0xbd, 0xe4, 0x8b, 0xa1, 0xce, 0xb0, 0x87};

	printf("\nAES_CIPHER_128 CBC encrypt test case:\n");
	printf("Input:\n");
	aes_dump("data", buf, sizeof(buf));
	aes_dump("key ", key, sizeof(key));
	aes_dump("IV ", iv, sizeof(iv));

	aes_encrypt_cbc(AES_CYPHER_128, buf, sizeof(buf), key, iv);
	aes_dump("cipher", buf, sizeof(buf));

	printf("\nAES_CIPHER_128 CBC decrypt test case:\n");
	printf("Input:\n");
	aes_dump("data", buf, sizeof(buf));
	aes_dump("key ", key, sizeof(key));
	aes_dump("IV ", iv, sizeof(iv));

	aes_decrypt_cbc(AES_CYPHER_128, buf, sizeof(buf), key, iv);
	aes_dump("plain", buf, sizeof(buf));
}

////////////////////////////////////////////////////////////////////////////
//CTR
void aes_cypher_ctr_128_test()
{

	uint8_t buf[] = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
					 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff,
					 0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
					 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff};
	
	
	// uint8_t buf[] = {0xad, 0x8d, 0x4f, 0x52, 0xad, 0x79, 0x68, 0xb6,  //test
	// 				 0x8a, 0x05, 0xad, 0xa5, 0xab, 0xa5, 0x73, 0x00,
	// 				 0xe1, 0x7b, 0x42, 0xe4, 0xab, 0x77, 0x00, 0x0f,
	// 				 0x17, 0xdf, 0xea, 0x95, 0xbe, 0xc6, 0xde, 0x8a};  //ctrl+k+c add exegesis,ctrl+k+u cancel exegesis

	uint8_t key[] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
					 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f};
	uint8_t iv[] = {0x60, 0xef, 0x17, 0x10, 0xd7, 0xcc, 0x28, 0xf8,
					0x56, 0xbd, 0xe4, 0x8b, 0xa1, 0xce, 0xb0, 0x87};

	printf("\nAES_CIPHER_128 CTR encrypt test case:\n");
	printf("Input:\n");
	aes_dump("data", buf, sizeof(buf));
	aes_dump("key ", key, sizeof(key));
	aes_dump("IV ", iv, sizeof(iv));

	aes_xcrypt_ctr(AES_CYPHER_128, buf, sizeof(buf), key, iv);
	aes_dump("cipher", buf, sizeof(buf));

	printf("\nAES_CIPHER_128 CTR decrypt test case:\n");
	printf("Input:\n");
	aes_dump("data", buf, sizeof(buf));
	aes_dump("key ", key, sizeof(key));
	aes_dump("IV ", iv, sizeof(iv));

	aes_xcrypt_ctr(AES_CYPHER_128, buf, sizeof(buf), key, iv);
	aes_dump("plain", buf, sizeof(buf));
}
///////////////////////////////////////////////////////////////////////////
//CTR

//********CFB*******//
void aes_cypher_cfb_128_test()
{

	uint8_t buf[] = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
					 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff,
					 0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
					 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff};

	uint8_t key[] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
					 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f};
	uint8_t iv[] = {0x60, 0xef, 0x17, 0x10, 0xd7, 0xcc, 0x28, 0xf8,
					0x56, 0xbd, 0xe4, 0x8b, 0xa1, 0xce, 0xb0, 0x87};

	printf("\nAES_CIPHER_128 CFB encrypt test case:\n");
	printf("Input:\n");
	aes_dump("data", buf, sizeof(buf));
	aes_dump("key ", key, sizeof(key));
	aes_dump("IV ", iv, sizeof(iv));

	aes_xcrypt_cfb(AES_CYPHER_128, buf, sizeof(buf), key, iv);
	aes_dump("cipher", buf, sizeof(buf));

	printf("\nAES_CIPHER_128 CFB decrypt test case:\n");
	printf("Input:\n");
	aes_dump("data", buf, sizeof(buf));
	aes_dump("key ", key, sizeof(key));
	aes_dump("IV ", iv, sizeof(iv));

	aes_xcrypt_cfb(AES_CYPHER_128, buf, sizeof(buf), key, iv);
	aes_dump("plain", buf, sizeof(buf));
}
//******************//

//********OFB*******//
void aes_cypher_ofb_128_test()
{

	uint8_t buf[] = {0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
					 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff,
					 0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
					 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff};
	
	uint8_t key[] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
					 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f};
	uint8_t iv[] = {0x60, 0xef, 0x17, 0x10, 0xd7, 0xcc, 0x28, 0xf8,
					0x56, 0xbd, 0xe4, 0x8b, 0xa1, 0xce, 0xb0, 0x87};

	printf("\nAES_CIPHER_128 OFB encrypt test case:\n");
	printf("Input:\n");
	aes_dump("data", buf, sizeof(buf));
	aes_dump("key ", key, sizeof(key));
	aes_dump("IV ", iv, sizeof(iv));

	aes_xcrypt_ofb(AES_CYPHER_128, buf, sizeof(buf), key, iv);
	aes_dump("cipher", buf, sizeof(buf));

	printf("\nAES_CIPHER_128 OFB decrypt test case:\n");
	printf("Input:\n");
	aes_dump("data", buf, sizeof(buf));
	aes_dump("key ", key, sizeof(key));
	aes_dump("IV ", iv, sizeof(iv));

	aes_xcrypt_ofb(AES_CYPHER_128, buf, sizeof(buf), key, iv);
	aes_dump("plain", buf, sizeof(buf));
}
//******************//

int main()
{
	aes_cypher_128_test();
	aes_cypher_ecb_128_test();
	aes_cypher_cbc_128_test();
	/////////////////////////////
	aes_cypher_ctr_128_test();
	/////////////////////////////
	//********CFB*******//
	aes_cypher_cfb_128_test();
	//******************//
	//********OFB*******//
	aes_cypher_ofb_128_test();
	//******************//
	return 0;
}
